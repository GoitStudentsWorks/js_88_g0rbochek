const KEY = 'data';
localStorage.setItem(
  KEY,
  JSON.stringify([
    {
      _id: '6462a8f74c3d0ddd28897fc1',
      title: 'Chocolate Gateau',
      category: 'Dessert',
      area: 'French',
      instructions:
        'Preheat the oven to 180°C/350°F/Gas Mark 4. Grease and line the base of an 8 in round spring form cake tin with baking parchment\r\nBreak the chocolate into a heatproof bowl and place over a saucepan of gently simmering water and stir until it melts. (or melt in the microwave for 2-3 mins stirring occasionally)\r\nPlace the butter and sugar in a mixing bowl and cream together with a wooden spoon until light and fluffy. Gradually beat in the eggs, adding a little flour if the mixture begins to curdle. Fold in the remaining flour with the cooled, melted chocolate and milk. Mix until smooth.\r\nSpread the mixture into the cake tin and bake for 50-55 mins or until firm in the centre and a skewer comes out cleanly. Cool for 10 minutes, then turn out and cool completely.',
      description:
        'A French dessert consisting of layers of chocolate sponge cake and chocolate ganache, typically topped with chocolate glaze and chocolate decorations.',
      thumb:
        'https://www.themealdb.com/images/media/meals/tqtywx1468317395.jpg',
      preview:
        'https://www.themealdb.com/images/media/meals/tqtywx1468317395.jpg',
      time: '75',
      youtube: 'https://www.youtube.com/watch?v=dsJtgmAhFF4',
      tags: ['Cake', 'Chocolate', 'Desert', 'Pudding'],
      ingredients: [
        {
          id: '640c2dd963a319ea671e3742',
          measure: '250g',
        },
        {
          id: '640c2dd963a319ea671e367e',
          measure: '175g',
        },
        {
          id: '640c2dd963a319ea671e371f',
          measure: '2 tablespoons',
        },
        {
          id: '640c2dd963a319ea671e36ca',
          measure: '5',
        },
        {
          id: '640c2dd963a319ea671e36ee',
          measure: '175g',
        },
        {
          id: '640c2dd963a319ea671e36d7',
          measure: '125g',
        },
      ],
      rating: 4.22,
    },
    {
      _id: '6462a8f74c3d0ddd28897fbc',
      title: 'Irish stew',
      category: 'Beef',
      area: 'Irish',
      instructions:
        "Heat the oven to 180C/350F/gas mark 4. Drain and rinse the soaked wheat, put it in a medium pan with lots of water, bring to a boil and simmer for an hour, until cooked. Drain and set aside.\r\n\r\nSeason the lamb with a teaspoon of salt and some black pepper. Put one tablespoon of oil in a large, deep sauté pan for which you have a lid; place on a medium-high heat. Add some of the lamb – don't overcrowd the pan – and sear for four minutes on all sides. Transfer to a bowl, and repeat with the remaining lamb, adding oil as needed.\r\n\r\nLower the heat to medium and add a tablespoon of oil to the pan. Add the shallots and fry for four minutes, until caramelised. Tip these into the lamb bowl, and repeat with the remaining vegetables until they are all nice and brown, adding more oil as you need it.\r\n\r\nOnce all the vegetables are seared and removed from the pan, add the wine along with the sugar, herbs, a teaspoon of salt and a good grind of black pepper. Boil on a high heat for about three minutes.\r\n\r\nTip the lamb, vegetables and whole wheat back into the pot, and add the stock. Cover and boil for five minutes, then transfer to the oven for an hour and a half.\r\n\r\nRemove the stew from the oven and check the liquid; if there is a lot, remove the lid and boil for a few minutes.",
      description:
        'A traditional Irish dish made with lamb, potatoes, carrots, onions, and herbs, cooked in a broth or gravy.',
      thumb:
        'https://www.themealdb.com/images/media/meals/sxxpst1468569714.jpg',
      preview:
        'https://www.themealdb.com/images/media/meals/sxxpst1468569714.jpg',
      time: '160',
      youtube: 'https://www.youtube.com/watch?v=kYH2qJXnSMo',
      tags: ['Stew', 'Meat'],
      ingredients: [
        {
          id: '640c2dd963a319ea671e3796',
          measure: '300g soaked overnight in water',
        },
        {
          id: '640c2dd963a319ea671e370c',
          measure: '2kg cut into 3cm cubes',
        },
        {
          id: '640c2dd963a319ea671e372c',
          measure: '120ml',
        },
        {
          id: '640c2dd963a319ea671e3765',
          measure: '24 Skinned',
        },
        {
          id: '640c2dd963a319ea671e3684',
          measure: '4 large',
        },
        {
          id: '640c2dd963a319ea671e3784',
          measure: '2',
        },
        {
          id: '640c2dd963a319ea671e3689',
          measure: '1',
        },
        {
          id: '640c2dd963a319ea671e368d',
          measure: '350g',
        },
        {
          id: '640c2dd963a319ea671e3794',
          measure: '150ml',
        },
        {
          id: '640c2dd963a319ea671e3687',
          measure: '1 tsp',
        },
        {
          id: '640c2dd963a319ea671e36de',
          measure: '4 sprigs',
        },
        {
          id: '640c2dd963a319ea671e3731',
          measure: '4 sprigs',
        },
        {
          id: '640c2dd963a319ea671e3696',
          measure: '450ml',
        },
      ],
      rating: 4.44,
    },
    {
      _id: '6462a8f74c3d0ddd28897fb9',
      title: 'Lamb tomato and sweet spices',
      category: 'Lamb',
      area: 'Moroccan',
      instructions:
        "Use pickled vine leaves here, preserved in brine. Small delicate leaves are better than the large bristly ones but, if only large leaves are to hand, then trim them to roughly 12 by 12 cms so that you don't get too many layers of leaves around the filling. And remove any stalks. Drain the preserved leaves, immerse them in boiling water for 10 minutes and then leave to dry on a tea towel before use. \r\nBasmati rice with butter and pine nuts is an ideal accompaniment. Couscous is great, too. Serves four.\r\nFirst make the filling. Put all the ingredients, apart from the tomatoes, in a bowl. Cut the tomatoes in half, coarsely grate into the bowl and discard the skins. Add half a teaspoon of salt and some black pepper, and stir. Leave on the side, or in the fridge, for up to a day. Before using, gently squeeze with your hands and drain away any juices that come out.\r\nTo make the sauce, heat the oil in a medium pan. Add the ginger and garlic, cook for a minute or two, taking care not to burn them, then add the tomato, lemon juice and sugar. Season, and simmer for 20 minutes.\r\nWhile the sauce is bubbling away, prepare the vine leaves. Use any torn or broken leaves to line the base of a wide, heavy saucepan. Trim any leaves from the fennel, cut it vertically into 0.5cm-thick slices and spread over the base of the pan to cover completely.\r\nLay a prepared vine leaf (see intro) on a work surface, veiny side up. Put two teaspoons of filling at the base of the leaf in a 2cm-long by 1cm-wide strip. Fold the sides of the leaf over the filling, then roll it tightly from bottom to top, in a cigar shape. Place in the pan, seam down, and repeat with the remaining leaves, placing them tightly next to each other in lines or circles (in two layers if necessary).\r\nPour the sauce over the leaves (and, if needed, add water just to cover). Place a plate on top, to weigh the leaves down, then cover with a lid. Bring to a boil, reduce the heat and cook on a bare simmer for 70 minutes. Most of the liquid should evaporate. Remove from the heat, and leave to cool a little - they are best served warm. When serving, bring to the table in the pan - it looks great. Serve a few vine leaves and fennel slices with warm rice. Spoon the braising juices on top and garnish with coriander.",
      description:
        'A Moroccan-inspired dish made with lamb, tomatoes, onions, and spices (such as cinnamon, ginger, and cumin), typically served with couscous or bread.',
      thumb:
        'https://www.themealdb.com/images/media/meals/qtwtss1468572261.jpg',
      preview:
        'https://www.themealdb.com/images/media/meals/qtwtss1468572261.jpg',
      time: '90',
      youtube: 'https://www.youtube.com/watch?v=vaZb1MnFBgA',
      tags: [''],
      ingredients: [
        {
          id: '640c2dd963a319ea671e372c',
          measure: '2 tbsp',
        },
        {
          id: '640c2dd963a319ea671e36e8',
          measure: '4cm piece finely chopped',
        },
        {
          id: '640c2dd963a319ea671e36e3',
          measure: '2 cloves peeled and chopped',
        },
        {
          id: '640c2dd963a319ea671e377f',
          measure: '800g peeled and chopped ',
        },
        {
          id: '640c2dd963a319ea671e3712',
          measure: '2 tbsp',
        },
        {
          id: '640c2dd963a319ea671e3687',
          measure: '1 tsp',
        },
        {
          id: '640c2dd963a319ea671e378d',
          measure: '50',
        },
        {
          id: '640c2dd963a319ea671e36d0',
          measure: '1 large',
        },
        {
          id: '640c2dd963a319ea671e370d',
          measure: '400g',
        },
        {
          id: '640c2dd963a319ea671e37ae',
          measure: '1 medium',
        },
        {
          id: '640c2dd963a319ea671e3669',
          measure: '2 tbsp',
        },
        {
          id: '640c2dd963a319ea671e36a0',
          measure: '2 tbsp',
        },
        {
          id: '640c2dd963a319ea671e36af',
          measure: '2 tbsp chopped',
        },
        {
          id: '640c2dd963a319ea671e36a5',
          measure: '½ tsp ground ',
        },
      ],
      rating: 3.83,
    },
    {
      _id: '6462a8f74c3d0ddd28897fdf',
      title: 'Lamb Rogan josh',
      category: 'Lamb',
      area: 'Indian',
      instructions:
        '\r\nPut the onions in a food processor and whizz until very finely chopped. Heat the oil in a large heavy-based pan, then fry the onion with the lid on, stirring every now and then, until it is really golden and soft. Add the garlic and ginger, then fry for 5 mins more.\r\nTip the curry paste, all the spices and the bay leaves into the pan, with the tomato purée. Stir well over the heat for about 30 secs, then add the meat and 300ml water. Stir to mix, turn down the heat, then add the yogurt.\r\nCover the pan, then gently simmer for 40-60 mins until the meat is tender and the sauce nice and thick. Serve scattered with coriander, with plain basmati or pilau rice.',
      description:
        'A spicy lamb dish from Kashmiri cuisine, flavored with a blend of aromatic spices and yogurt.',
      thumb:
        'https://www.themealdb.com/images/media/meals/vvstvq1487342592.jpg',
      preview:
        'https://www.themealdb.com/images/media/meals/vvstvq1487342592.jpg',
      time: '90',
      youtube: 'https://www.youtube.com/watch?v=NZVo32n7iS8',
      tags: ['Curry', 'Spicy', 'Alcoholic'],
      ingredients: [
        {
          id: '640c2dd963a319ea671e37ae',
          measure: '2 quartered',
        },
        {
          id: '640c2dd963a319ea671e3776',
          measure: '4 tbsp',
        },
        {
          id: '640c2dd963a319ea671e36e3',
          measure: '4 cloves',
        },
        {
          id: '640c2dd963a319ea671e36e8',
          measure: 'Thumb sized peeled and very finely grated',
        },
        {
          id: '640c2dd963a319ea671e371a',
          measure: '2 tbsp',
        },
        {
          id: '640c2dd963a319ea671e3733',
          measure: '2 tsp',
        },
        {
          id: '640c2dd963a319ea671e36a6',
          measure: '1',
        },
        {
          id: '640c2dd963a319ea671e3683',
          measure: '6 bashed to break shells',
        },
        {
          id: '640c2dd963a319ea671e366a',
          measure: '2',
        },
        {
          id: '640c2dd963a319ea671e370b',
          measure: '1kg cubed',
        },
        {
          id: '640c2dd963a319ea671e36f0',
          measure: '150ml',
        },
        {
          id: '640c2dd963a319ea671e36af',
          measure: 'Garnish chopped ',
        },
      ],
      rating: 3.84,
    },
  ])
);

const allButton = document.querySelector('.hero-favorite-buttons');
const btnAllCategories = document.querySelector(
  '.js-hero-favorite-all-categories-listener'
);
const data = JSON.parse(localStorage.getItem(KEY)) ?? [];
const list = document.querySelector('.hero-favorite-cards');

allButton.addEventListener('click', handlerClick);
btnAllCategories.addEventListener('click', handlerResetCategories);

if (data.length) {
  console.log(data);
  const markup = createButtons(data);
  console.log(markup);
  allButton.innerHTML = markup;
}

function handlerClick(evt) {
  if (!evt.target.classList.contains('js-select-category')) {
    return;
  }

  const btnSelectCtg = document.querySelectorAll('.js-select-category');
  btnSelectCtg.forEach(button => {
    if (button.classList.contains('hero-favorite-btn-active')) {
      button.classList.remove('hero-favorite-btn-active');
    }
  });
  evt.target.classList.add('hero-favorite-btn-active');
  btnAllCategories.classList.remove('hero-favorite-btn-active');
}

function handlerResetCategories() {
  const btnSelectCtg = document.querySelectorAll('.js-select-category');
  btnSelectCtg.forEach(button => {
    if (button.classList.contains('hero-favorite-btn-active')) {
      button.classList.remove('hero-favorite-btn-active');
    }
  });
  btnAllCategories.classList.add('hero-favorite-btn-active');
}

// function createMarkup(arr) {
//   return arr.map({ category, title, description, preview, rating, _id: id });
// }

function addMealToDOM(recipes) {
  const markup = recipes
    .map(item => {
      const { description, rating, thumb, title, _id: id } = item;
      ratingStar = rating;
      return `
        <li class="main-img-items">
                    <img class="main-img-img" src="${thumb}" alt="${title}" />
                    <div class="main-heart">
                      <button type="button" id="${id}" class="main-heart-btn">
    <svg class="heart-icon" xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22" >
    <path opacity="0.5" fill-rule="evenodd" clip-rule="evenodd" d="M10.9939 4.70783C9.16115 2.5652 6.10493 1.98884 3.80863 3.95085C1.51234 5.91285 1.18905 9.19323 2.99234 11.5137C4.49166 13.443 9.02912 17.5121 10.5163 18.8291C10.6826 18.9764 10.7658 19.0501 10.8629 19.0791C10.9475 19.1043 11.0402 19.1043 11.1249 19.0791C11.2219 19.0501 11.3051 18.9764 11.4715 18.8291C12.9586 17.5121 17.4961 13.443 18.9954 11.5137C20.7987 9.19323 20.5149 5.89221 18.1791 3.95085C15.8434 2.00948 12.8266 2.5652 10.9939 4.70783Z" stroke="#F8F8F8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>
  </button>
                    </div>
                    <div class="main-img-text-wrap">
                      <h3 class="main-img-title">${title}</h3>
                      <p class="main-img-text">
                        ${description}
                      </p>
                      <div class="main-img-subtext-wrap">
                        <div class="main-rating-wrap">
                          <span class="main-rating-span">${Math.round(
                            rating
                          )}</span>
                          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none">
    <path d="M6.04894 1.42705C6.3483 0.505742 7.6517 0.505741 7.95106 1.42705L8.79611 4.02786C8.92999 4.43989 9.31394 4.71885 9.74717 4.71885H12.4818C13.4505 4.71885 13.8533 5.95846 13.0696 6.52786L10.8572 8.13525C10.5067 8.3899 10.3601 8.84127 10.494 9.25329L11.339 11.8541C11.6384 12.7754 10.5839 13.5415 9.80017 12.9721L7.58779 11.3647C7.2373 11.1101 6.7627 11.1101 6.41222 11.3647L4.19983 12.9721C3.41612 13.5415 2.36164 12.7754 2.66099 11.8541L3.50604 9.25329C3.63992 8.84127 3.49326 8.3899 3.14277 8.13525L0.930391 6.52787C0.146677 5.95846 0.549452 4.71885 1.51818 4.71885H4.25283C4.68606 4.71885 5.07001 4.43989 5.20389 4.02786L6.04894 1.42705Z" fill="#EEA10C"/>
  </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none">
    <path d="M6.04894 1.42705C6.3483 0.505742 7.6517 0.505741 7.95106 1.42705L8.79611 4.02786C8.92999 4.43989 9.31394 4.71885 9.74717 4.71885H12.4818C13.4505 4.71885 13.8533 5.95846 13.0696 6.52786L10.8572 8.13525C10.5067 8.3899 10.3601 8.84127 10.494 9.25329L11.339 11.8541C11.6384 12.7754 10.5839 13.5415 9.80017 12.9721L7.58779 11.3647C7.2373 11.1101 6.7627 11.1101 6.41222 11.3647L4.19983 12.9721C3.41612 13.5415 2.36164 12.7754 2.66099 11.8541L3.50604 9.25329C3.63992 8.84127 3.49326 8.3899 3.14277 8.13525L0.930391 6.52787C0.146677 5.95846 0.549452 4.71885 1.51818 4.71885H4.25283C4.68606 4.71885 5.07001 4.43989 5.20389 4.02786L6.04894 1.42705Z" fill="#EEA10C"/>
  </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none">
    <path d="M6.04894 1.42705C6.3483 0.505742 7.6517 0.505741 7.95106 1.42705L8.79611 4.02786C8.92999 4.43989 9.31394 4.71885 9.74717 4.71885H12.4818C13.4505 4.71885 13.8533 5.95846 13.0696 6.52786L10.8572 8.13525C10.5067 8.3899 10.3601 8.84127 10.494 9.25329L11.339 11.8541C11.6384 12.7754 10.5839 13.5415 9.80017 12.9721L7.58779 11.3647C7.2373 11.1101 6.7627 11.1101 6.41222 11.3647L4.19983 12.9721C3.41612 13.5415 2.36164 12.7754 2.66099 11.8541L3.50604 9.25329C3.63992 8.84127 3.49326 8.3899 3.14277 8.13525L0.930391 6.52787C0.146677 5.95846 0.549452 4.71885 1.51818 4.71885H4.25283C4.68606 4.71885 5.07001 4.43989 5.20389 4.02786L6.04894 1.42705Z" fill="#EEA10C"/>
  </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none">
    <path d="M6.04894 1.42705C6.3483 0.505742 7.6517 0.505741 7.95106 1.42705L8.79611 4.02786C8.92999 4.43989 9.31394 4.71885 9.74717 4.71885H12.4818C13.4505 4.71885 13.8533 5.95846 13.0696 6.52786L10.8572 8.13525C10.5067 8.3899 10.3601 8.84127 10.494 9.25329L11.339 11.8541C11.6384 12.7754 10.5839 13.5415 9.80017 12.9721L7.58779 11.3647C7.2373 11.1101 6.7627 11.1101 6.41222 11.3647L4.19983 12.9721C3.41612 13.5415 2.36164 12.7754 2.66099 11.8541L3.50604 9.25329C3.63992 8.84127 3.49326 8.3899 3.14277 8.13525L0.930391 6.52787C0.146677 5.95846 0.549452 4.71885 1.51818 4.71885H4.25283C4.68606 4.71885 5.07001 4.43989 5.20389 4.02786L6.04894 1.42705Z" fill="#EEA10C"/>
  </svg>
  
                          <svg width="14" height="14">
                            <use href="./images/icons.svg#icon-star"></use>
                          </svg>
                          <svg width="14" height="14">
                            <use href="./images/icons.svg#icon-empty-star"></use>
                          </svg>
                        </div>
                        <button id="${id}" class="main-rating-btn">See recipe</button>
                      </div>
                    </div>
                  </li>
      `;
    })
    .join('');
  return markup;
}

// function filterArray(arr) {
//   return arr.filter((el, index, array) => array.indexOf(el) === index);
// }

function createButtons(data) {
  return data
    .map(
      ({ category }) => `<li>
    <button class="hero-favorites-btn-design js-select-category" type="button">${category}</button>  
    </li>`
    )
    .join('');
}

list.innerHTML = addMealToDOM(data);
